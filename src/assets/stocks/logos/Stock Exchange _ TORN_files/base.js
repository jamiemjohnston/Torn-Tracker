(function(global){'use strict';if(!global.console){global.console={};}
var con=global.console;var prop,method;var dummy=function(){};var properties=['memory'];var methods=('assert,clear,count,debug,dir,dirxml,error,exception,group,'+
'groupCollapsed,groupEnd,info,log,markTimeline,profile,profiles,profileEnd,'+
'show,table,time,timeEnd,timeline,timelineEnd,timeStamp,trace,warn').split(',');while(prop=properties.pop())if(!con[prop])con[prop]={};while(method=methods.pop())if(!con[method])con[method]=dummy;})(typeof window==='undefined'?this:window);function myTimestamp(){tstmp=new Date();return tstmp.getTime();}
function convertDateToUTC(date){return date;}
function ServerTimeService(){var self=this;var serverSyncFrequency=120000;var serverTimeElem=document.getElementById('serverTimestamp');var timeUpdatedEvent=document.createEvent('CustomEvent');timeUpdatedEvent.initCustomEvent('serverTimeUpdated',false,false,{});window.onfocus=function(){self.syncTimeWithServer();};this.timeNow=serverTimeElem?parseInt(serverTimeElem.getAttribute('data-timestamp'))*1000:Date.now();this.startClock=function(){setInterval(function(){self.timeNow+=1000;self.checkSynchronization();},1000);};this.syncTimeWithServer=function(){if(typeof(getAction)==="function"){getAction({type:"get",action:'/sidebarAjaxAction.php?action=servertime',success:function(resp){var data={};try{data=JSON.parse(resp)}catch(e){console.error('Some error happen during JSON parsing: ',resp)}
self.timeNow=data&&data.time?data.time:self.timeNow;if(self.timeNow){}
document.dispatchEvent(timeUpdatedEvent);}});}
else{console.warn('getAction is not defined');}};this.checkSynchronization=function(){if(self.timeNow%serverSyncFrequency===0&&document.hidden===false){self.syncTimeWithServer()}}}
var serverTimeService=new ServerTimeService();serverTimeService.startClock();function getCurrentTimestamp(){return serverTimeService.timeNow;}
function getCurrentTime(){return new Date(getCurrentTimestamp());}
function newWindow(htmlfile){htmlWindow=window.open(htmlfile,'newWin','width=250,height=146,toolbar=no,scrollbars=no');htmlWindow.focus();}
function getCookie(name){var r=document.cookie.match("\\b"+name+"=([^;]*)\\b");return r?r[1]:undefined;}
function addCommas(nStr){nStr+='';x=nStr.split('.');x1=x[0];x2=x.length>1?'.'+x[1]:'';var rgx=/(\d+)(\d{3})/;while(rgx.test(x1)){x1=x1.replace(rgx,'$1'+','+'$2');}
return x1+x2;}
jQuery.extend({getUrlVars:function(){var vars=[],hash;var hashes=window.location.href.slice(window.location.href.indexOf('?')+1).split('&');for(var i=0;i<hashes.length;i++)
{hash=hashes[i].split('=');vars.push(hash[0]);vars[hash[0]]=hash[1];}
return vars;},getUrlVar:function(name){return jQuery.getUrlVars()[name];}});function dump(arr,level){var dumped_text="";if(!level)level=0;var level_padding="";for(var j=0;j<level+1;j++)level_padding+="    ";if(typeof(arr)=='object'){for(var item in arr){var value=arr[item];if(typeof(value)=='object'){dumped_text+=level_padding+"'"+item+"' ...\n";dumped_text+=dump(value,level+1);}else{dumped_text+=level_padding+"'"+item+"' => \""+value+"\"\n";}}}else{dumped_text="===>"+arr+"<===("+typeof(arr)+")";}
return dumped_text;}
function isset(){var a=arguments,l=a.length,i=0;if(l===0){throw new Error('Empty isset');}
while(i!==l){if(typeof(a[i])=='undefined'||a[i]===null){return false;}else{i++;}}
return true;}
function loadImage(path){jQuery("#loadedContent").load(path);}
function countdownsTickCallback(){var $el=$(this),stepPercentage=parseInt($el.attr('data-until'))/parseInt($el.attr('data-timestep')),newUntil=parseInt($el.attr('data-until'))-parseInt($el.countdown('option','tickInterval')),newFillTimeLeft=parseInt($el.attr('data-filltimeleft'))-parseInt($el.countdown('option','tickInterval')),$parent=$el.closest('.energy-info'),$progressLineTimer=$el.closest('.energy-info').find('.progress-line-timer'),progressWidth=0,counter=1,filltimeleft=parseInt($el.attr('data-filltimeleft'));progressWidth=$parent.hasClass('chain-wrap')?Math.round(stepPercentage*100):(100-Math.round(stepPercentage*100));$progressLineTimer.css('width',progressWidth+"%");$el.attr('data-until',newUntil);$el.attr('data-filltimeleft',newFillTimeLeft);}
function checkClientAndServerTime(selector){var $el=selector;var fillTimeLeft=parseInt($el.attr('data-filltimeleft'));var fillTimeLeftHours=Math.floor(fillTimeLeft)/3600;var serverTime=parseInt($el.attr('data-stime'));var clientTime=Math.floor($.now()/1000);var sHours=new Date(serverTime).getHours();var cHours=new Date(clientTime).getHours();var difference=sHours-cHours;if(difference!=0&&(fillTimeLeftHours>0||difference>0)){$el.attr('data-filltimeleft',fillTimeLeftHours+difference);}}
function startCountdowns(){var refreshingEnergy=false;jQuery(".countdown").each(function(){var e=jQuery(this);checkClientAndServerTime(e);if(!isNaN(+e.data("until"))){var options={until:+e.data("until"),layout:e.data("layout"),onTick:countdownsTickCallback};if(e.data("on-expiry")=="refreshenergy")
options.onExpiry=function(){if(refreshingEnergy){return;}
refreshingEnergy=true;var statBars={};setStatBarsCookie();$('.menu-list .energy-info').each(function(){var $elem=$(this);statBars[$elem.attr('id')]=parseInt($elem.find('.count').attr('data-current'));});setStatBarsCookie(statBars);ajaxWrapper({type:"POST",url:location.protocol+"//"+location.hostname+"/refreshenergy.php",timeout:10*1000,onsuccess:function(data){jQuery("#player-stats").html(jQuery(data).html());startCountdowns();checkProgressOverfull();initializeTooltip('.menu-info .icons','white-tooltip');initializeStatBarTooltip('.menu-list .energy-info-cont .energy-info','white-tooltip stat-bar-tooltip');window.sidebarIconsLiveTime=0;refreshingEnergy=false;},onerror:function(){refreshingEnergy=false;}});};e.countdown(options);}});}
function checkCookiePanel(){if(window.location.pathname=='/'){var cookieValue=localStorage.getItem('hideCookiePanel');var cookiePanel=$('.cookie-notif-panel');$('.cookie-notif-container div.btn-mobile, .cookie-notif-container div.btn-desktop').on('click',function(){localStorage.setItem('hideCookiePanel',true);cookiePanel.css('display','none');});if(!cookieValue){cookiePanel.css('display','block');}else{cookiePanel.css('display','none');}}}
jQuery(document).ready(function(){startCountdowns();checkCookiePanel();});